---
- job:
    name: ubuntu-hoist
    node: 'ubuntu-hoist'

    builders:
      - zuul-git-prep
      - install-ansible
      - shell: |
          source /opt/venvs/ansible/bin/activate
          ansible-galaxy install -r requirements.yml
          ansible-playbook -i inventory/nodepool.py install-ci.yml --skip-tags monitoring -e @secrets.yml.example
          ansible-playbook -i inventory/nodepool.py  tests/validate-ci.yml

    publishers:
      - console-log

- job:
    name: hoist-checks
    node: 'ubuntu-xenial'

    builders:
      - zuul-git-prep
      - shell: |
          python tests/layout-checks.py job-list.txt
          ./tests/shellcheck-test.sh
          ./tests/signed-off-by-test.sh
